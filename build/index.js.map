{"version":3,"sources":["../src/index.js"],"names":["process","platform","require","config","app","use","superSecretApiKeys","env","APIKEYS","split","doEnterpriseLevelSecurityCheck","get","req","res","send","doh","json","message","character","headers","apikey","search","query","console","log","JSON","stringify","EnterpriseLevelSecurityCheck","then","passed","Object","keys","queryProp","capitalize","queryText","decodeURIComponent","charResults","SaaSData","filter","char","length","Promise","resolve","reject","includes","s","charAt","toUpperCase","slice","listen","PORT"],"mappings":"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","sourcesContent":["// @ts-ignore\nimport SaaSData from './saasdata.json';\nimport express from 'express'; // framework\nimport morgan from 'morgan'; // request logger\nif (process.platform === \"darwin\") { require(\"dotenv\").config() }\nconst app = express() // express app\napp.use(morgan('tiny')) // morgan\n\n\n// MICKEY MOUSE ENTERPRISE-GRADE SECURITY AS A SERVICE\nconst superSecretApiKeys = process.env.APIKEYS.split(\",\")\nconst doEnterpriseLevelSecurityCheck = true;\n\napp.get('/', (req, res) => { res.send(`<h1>SaaS - Simpsons as a Service</h1>`) }) // default route\n\n// DaaS\nlet doh = app.get('/doh', (req, res) => { res.json({ message: \"D'oh!\" }) }) // D'oh!\n\n// character route\nlet character = app.get([\"/characters\", \"/api/characters\", \"/chars\"], (req, res) => {\n    let headers = req.headers;\n    let apikey = req.headers.apikey;\n    let search = req.query;\n    console.log(`APIKEY: ${JSON.stringify(apikey) || \"none\"}`)\n    EnterpriseLevelSecurityCheck(req, res).then(passed => {\n        if (!passed) return;\n        console.log(`queryprop: ${Object.keys(search)[0]}`)\n        if (!Object.keys(search)[0]) { res.send(`<h1>SaaS character-endpoint. Retrieve a character using ?name=[charactername] </h1>`) } else {\n            let queryProp = capitalize(Object.keys(search)[0])\n            let queryText = decodeURIComponent(search[queryProp])\n            let charResults = SaaSData.filter(char => { if (!char[queryProp]) { return false; } return char[queryProp] == queryText })\n            if (charResults.length) { res.send(JSON.stringify([...charResults])) }\n            else {\n                res.send(`No character with ${queryProp} ${queryText} in the SaaS-database`)\n            }\n        }\n    });\n})\n\nfunction EnterpriseLevelSecurityCheck(req, res) {\n    return new Promise((resolve, reject) => {\n        if (!doEnterpriseLevelSecurityCheck) { resolve(true); return; }\n        if (!req.headers.apikey) {\n            res.send(`NO API KEY SPECIFIED. ASK PUZZLEBART FOR ONE! We're all about sharing :D`)\n            resolve(false)\n        } else {\n            if (superSecretApiKeys.includes(req.headers.apikey)) { resolve(true) } else {\n                res.send(`WRONG API KEY SPECIFIED. ARE YOU HACKING???!`)\n                resolve(false)\n            }\n        }\n    })\n}\n\n// Stupid sexy jslint\nconst capitalize = (s) => { if (typeof s !== 'string') return ''; return s.charAt(0).toUpperCase() + s.slice(1) }\n\napp.listen(process.env.PORT || '3000', () => console.log(`running on port ${process.env.PORT || '3000'}`)) // starting\n"],"file":"index.js"}