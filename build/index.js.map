{"version":3,"sources":["../src/index.js"],"names":["process","platform","require","config","app","use","REQUIRED_REACTOR_POWER_IN_GIGAWATTS","REACTOR_TOO_MUCH_POWER","req","res","next","header","superSecretApiKeys","env","APIKEYS","split","doEnterpriseLevelSecurityCheck","randomize","min","max","Math","round","random","tihi","get","redirect","version","json","doh","message","quotes","EnterpriseLevelSecurityCheck","then","passed","charsWithQuotes","SaaSData","filter","char","Quotes","length","getRandomChar","getRandomQuote","getRandomQuoteObject","rChar","rQuote","Quote","Name","Picture","query","amount","console","log","isNaN","parseInt","error","chars","i","push","search","q","decodeURIComponent","toLowerCase","matches","name","occupation","Occupation","indexOf","character","JSON","stringify","headers","apikey","url","getRandomCharacter","randomChars","Object","keys","send","queryProp","capitalize","queryText","charResults","ReactorControllerHumidityCheck","Promise","resolve","reject","ignore","axios","response","data","watts","watt","includes","s","charAt","toUpperCase","slice","listen","PORT"],"mappings":"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","sourcesContent":["// @ts-ignore\nimport SaaSData from './saasdata.json'; // scalable enterprise-grade JSON document storage\nimport express from 'express'; // framework, yo\nimport morgan from 'morgan'; // request logger\nimport axios from \"axios\";\nif (process.platform === \"darwin\") { require(\"dotenv\").config() } // enterprise-grade MacOS-detection\nconst app = express() // express app instance\napp.use(morgan('tiny')) // morgan\n\n\nconst REQUIRED_REACTOR_POWER_IN_GIGAWATTS = 30000\nconst REACTOR_TOO_MUCH_POWER = 50000\n\n\n//CORS\napp.use(function (req, res, next) {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    // Remember to have apikey here, else our enterprise-grade authorization-system will fail\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Content-Length, Cache-Control, Accept, apikey\");\n    next();\n});\n\n\n// MICKEY MOUSE ENTERPRISE-GRADE SECURITY AS A SERVICE\nconst superSecretApiKeys = process.env.APIKEYS.split(\",\")\nconst doEnterpriseLevelSecurityCheck = true;\n// ENTERPRISE GRADE RANDOMIZATION ENGINE\nconst randomize = (min, max) => Math.round((Math.random() * (max - min) + min))\n\n// TIHIaaS -  Thanks, I hate it as a Service\nlet tihi = app.get('/tihi', (req, res) => { res.redirect(\"https://www.youtube.com/watch?v=-Lez_WdX7Oc\") })\n\n// version\nlet version = app.get(\"/version\", (req, res) => { res.json({ version: \"1.0.0\" }) })\n\n// DaaS - DÂ´oh! as a Service\nlet doh = app.get('/doh', (req, res) => { res.json({ message: \"D'oh!\" }) }) // D'oh!\n\nlet quotes = app.get('/quotes', (req, res) => {\n    EnterpriseLevelSecurityCheck(req, res).then(passed => { // VERY IMPORTANT SECURITY STUUFF\n        let charsWithQuotes = SaaSData.filter(char => char.Quotes.length >= 1)\n        const getRandomChar = () => charsWithQuotes[randomize(0, charsWithQuotes.length - 1)]\n        const getRandomQuote = (char) => char.Quotes.length === 1 ? char.Quotes[0] : char.Quotes[randomize(0, char.Quotes.length - 1)];\n        const getRandomQuoteObject = () => {\n            let rChar = getRandomChar()\n            let rQuote = getRandomQuote(rChar)\n            return { Quote: rQuote, Name: rChar.Name, Picture: rChar.Picture }\n        }\n        if (!req.query.amount) {\n            console.log(\"getting random quote\")\n            // sensible - random by default\n            // God this is so horrible\n            res.json(getRandomQuoteObject())\n        } if (req.query.amount) {\n            if (isNaN(parseInt(req.query.amount))) { res.json({ error: \"YOU HAVE TO SPECIFY A NUMBER AS AMOUNT, DOOFUS\" }) }\n            let chars = []\n            for (let i = 0; i < req.query.amount; i++) { chars.push(getRandomQuoteObject()) }\n            res.json(chars)\n        }\n        else {\n            console.log(req.query)\n        }\n    })\n})\n\n// SEARCH FUNCTION YEAOIAUSODIUASDOIS\nlet search = app.get([\"/search\", \"/find\"], (req, res) => {\n    EnterpriseLevelSecurityCheck(req, res).then(passed => {\n        let q = req.query.q;\n        if (!q) res.json({ error: \"no query specified. use ?q=[querystring]\" })\n        if (q.length < 3) { res.json({ message: \"type at least three characters to search\" }) } else {\n            q = decodeURIComponent(q.toLowerCase());\n            let matches = SaaSData.filter(char => {\n                let name = char.Name ? char.Name.toLowerCase() : \"\";\n                let occupation = char.Occupation ? char.Occupation.toLowerCase() : \"\";\n                return name.indexOf(q) > -1 || occupation.indexOf(q) > -1\n            })\n            res.json(matches)\n        }\n    })\n})\n\n// character route\nlet character = app.get([\"/characters\", \"/api/characters\", \"/chars\", \"/characters/random\"], (req, res) => {\n    console.log(`APIKEY: ${JSON.stringify(req.headers.apikey) || \"none\"}`)\n    EnterpriseLevelSecurityCheck(req, res).then(passed => {\n        if (!passed) return;\n        let search = req.query;\n        if (req.url.indexOf(\"/random\") > -1) {\n            const getRandomCharacter = () => SaaSData[randomize(0, SaaSData.length)];\n            //return random character\n            if (req.query.amount) {\n                if (isNaN(parseInt(req.query.amount))) { res.json({ error: \"YOU HAVE TO SPECIFY A NUMBER AS AMOUNT, DOOFUS\" }) }\n                let randomChars = []\n                for (let i = 0; i < req.query.amount; i++) { randomChars.push(getRandomCharacter()) }\n                res.json(randomChars)\n            }\n            res.json(SaaSData[randomize(0, SaaSData.length)])\n        }\n        console.log(`queryprop: ${Object.keys(search)[0]}`)\n        if (!Object.keys(search)[0]) { res.send(`<h1>SaaS character-endpoint. Retrieve a character using ?name=[charactername] or ?id=[characterId] </h1>`) } else {\n            let queryProp = capitalize(Object.keys(search)[0])\n            let queryText = decodeURIComponent(search[queryProp])\n            let charResults = SaaSData.filter(char => { if (!char[queryProp]) { return false; } return char[queryProp] == queryText })\n            if (charResults.length) { res.json([...charResults]) }\n            else {\n                res.send(`No character with ${queryProp} ${queryText} in the SaaS-database`)\n            }\n        }\n    });\n})\n\nfunction ReactorControllerHumidityCheck(req, res) {\n    return new Promise((resolve, reject) => {\n        if (req.headers.ignore == \"true\" || req.query.ignore == \"true\") { resolve(true) } else {\n            axios.get('https://reactorapi20190302034437.azurewebsites.net/api/CanServerLive?code=41b/36amxQJFkHR94dhMTyyM7A46vxOgu6Bw4yigAyojYucsH3P4Lw==')\n                .then(response => {\n                    console.log(`got reactor core data:`)\n                    console.log(JSON.stringify(response.data))\n                    let watts = Math.round(response.data.watt)\n                    if (watts < REQUIRED_REACTOR_POWER_IN_GIGAWATTS && watts !== 0) {\n                        console.log(`---------- WARNING ------------- REACTOR POWER LESS THAN 30GW, currently at ${watts}GW`)\n                        resolve([true, watts]) // CHANGE TO FALSE\n                    } else if (watts > REQUIRED_REACTOR_POWER_IN_GIGAWATTS) {\n                        console.log(`--------ALL GOOD, REACTOR POWER AT ${watts}GW`)\n                        resolve([true, watts])\n                    } else {\n                        console.log(`--------REACTOR POWER DETECTOR CURRENTLY UNAVAILABLE--------`)\n                        resolve([true, watts]) // fuck this guy\n                    }\n                })\n        }\n    })\n}\n\n\n// ENTERPRISE LEVEL SECURITY ENGINE AUTOMATRON - DO NOT TOUCH IT'S PERFECT THANKS\nfunction EnterpriseLevelSecurityCheck(req, res) {\n    return new Promise((resolve, reject) => {\n        if (!doEnterpriseLevelSecurityCheck || req.get('host').indexOf(\"localhost\") > -1) { resolve(true); return; }\n        if (!req.headers.apikey && !req.query.apikey) {\n            res.json({ error: `NO API KEY SPECIFIED. ASK PUZZLEBART FOR ONE! We're all about sharing :D` })\n            resolve(false)\n        } else {\n            if (superSecretApiKeys.includes(req.headers.apikey) || superSecretApiKeys.includes(req.query.apikey)) { resolve(true) } else {\n                res.json({ error: `WRONG API KEY SPECIFIED - ARE YOU HACKING???!` })\n                resolve(false)\n            }\n        }\n    })\n}\n// END SECURITIFICATION\n\n\n// Stupid sexy jslint\nconst capitalize = (s) => { if (typeof s !== 'string') return ''; return s.charAt(0).toUpperCase() + s.slice(1) }\n\n\n// FRONT PAGE\napp.get('/', (req, res) => {\n    ReactorControllerHumidityCheck(req, res).then(([passed, watts]) => {\n        res.send(`<!DOCTYPE html>\n<html>\n<head>\n    <title>Simpsons as a Service</title>\n    <link href=\"//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css\"\n        rel=\"stylesheet\">\n    <meta name=\"twitter:card\" content=\"summary\">\n    <meta name=\"twitter:creator\" content=\"@Kimzter\">\n    <meta name=\"og:title\" content=\"Simpsons As A Service\">\n    <meta name=\"og:description\" content=\"SaaS provides a modern, RESTful, scalable API for Simpsons character data.\">\n    <script src=\"//code.jquery.com/jquery-3.1.1.min.js\" type=\"text/javascript\"></script>\n</head>\n\n<body>\n    <div class=\"container\">\n        <div class=\"hero-unit\">\n            <h1>SaaS</h1>\n            <h2>Simpsons As A Service</h2>\n            <p><em>v1.0.0 - <br/><b>REACTOR POWER ${watts !== 0 ? watts<REQUIRED_REACTOR_POWER_IN_GIGAWATTS ? \"TOO LOW, SHOULD BE >30000KW, CURRENTLY AT \"+watts+\"KW.<br/>API REQUESTS MIGHT BE SLOW\" : \"PRETTY GOOD, CURRENTLY AT \"+watts+\"KW\" : \"UNAVAILABLE, API REQUESTS MIGHT BE SLOW\"}</b></em></p>\n        </div>\n    </div>\n    <div class=\"container\">\n        <div class=\"content\" style=\"margin-left:50px;\">\n            <h2 id=\"introduction\">Introduction</h2>\n            <p>SaaS (Simpsons As A Service) provides a modern, RESTful, scalable way of getting Simpsons Character data</p>\n            <h2 id=\"api\">API</h2>\n            <h3 id=\"contentnegotiation\">Content Negotiation</h3>\n            <p>SaaS responds in JSON format</p>\n            <h3 id=\"operations\">Operations</h3>\n            <table class=\"table\" id=\"ops\">\n                <tr>\n                    <th>Path</th>\n                    <th>Description</th>\n                </tr>\n                <tr>\n                    <td>/version</td>\n                    <td>Returns the current SaaS version number.</td>\n                </tr>\n                <tr>\n                    <td>/characters</td>\n                    <td>The main character endpoint</td>\n                </tr>\n                <tr>\n                    <td>/characters/random</td>\n                    <td>Returns a random character</td>\n                </tr>\n                <tr>\n                    <td>/doh</td>\n                    <td>D'oh! As A Service</td>\n                </tr>\n                <tr>\n                    <td>/quotes</td>\n                    <td>Returns a random quote, as well as the name and photo of the quotee</td>\n                </tr>\n                <tr>\n                    <td>/find</td>\n                    <td>Search function. Takes q as input parameter, e.g. /find?q=Bart Simpson</td>\n                </tr>\n                <tr>\n                    <td>/tihi</td>\n                    <td>TIHIaas - Thanks, I hate it as a Service</td>\n                </tr>\n            </table>\n            <p>The <code>/characters/random</code> and <code>/quotes</code> endpoints support the <code>amount</code> switch. E.g. /characters/random?amount=10\n            <h3 id=\"operations\">Example usage</h3>\n            <p><b>cURL</b></p>\n            <code>curl -L \"http://saas.puzzlebart.no/characters?Name=Homer%20Simpson\" -H apikey:\"YOUR_API_KEY\"</code>\n            <br/>\n            <br/>\n            <p><b>fetch</b></p>\n            <code>await fetch(\"http://saas.puzzlebart.no/characters?Name=Homer%20Simpson\",{headers:{apikey:\"YOUR_API_KEY\"}}).then(d=>d.json().then(r=>r))</code>\n            <br/>\n            <br/>\n            <p><b>in-browser</b></p>\n            <code>http://saas.puzzlebart.no/characters?Name=Homer%20Simpson&apikey=EATMYSHORTS</code>\n            <p></p>\n            <p><a href=\"https://github.com/puzzlebart/saas\">Fork us on github!</a></p>\n            <p>Created by <a href=\"https://twitter.com/Kimzter\">@Kimzter</a></p>\n        </div>\n    </div>\n</body>\n</html>\n`)\n    })\n});\n\n// error route\napp.get('(/*)?', (req, res) => {\n    res.send(`\n<html>\n<head>\n    <title>Simpsons as a Service</title>\n    <link href=\"//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css\" rel=\"stylesheet\">\n    <meta name=\"og:title\" content=\"Simpsons As A Service\">\n    <script src=\"//code.jquery.com/jquery-3.1.1.min.js\" type=\"text/javascript\"></script>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"hero-unit\">\n            <h1>742 - D'oh!</h1>\n            <h2>This is not the endpoint you are looking for</h2>\n            <p><em>Simpsons as a Service v1.0.0</em></p>\n        </div>\n    </div>\n    <center><a href=\"/\">saas.puzzlebart.no</a>\n    </body></html>`)\n}) // D'oh!\n\napp.listen(process.env.PORT || '3000', () => console.log(`running on port ${process.env.PORT || '3000'}`))"],"file":"index.js"}